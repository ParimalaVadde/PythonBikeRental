vendor_contact = ["stg_business_entity_id", "vendor_contact_name"]

transformed_json_df.select(*ss.contacts).distinct().show()
    
    
    # Transform `transformed_contacts`
    transformed_contact = transformed_json_df.select(*ss.contacts).distinct().withColumnRenamed(
        "associated_people__name", "contact_name"
    ).withColumnRenamed(
        "associated_people__title", "contact_title"
    )

    vendor_contact_df = transformed_df.select(*ss.vendor_contact).distinct()

    vendor_contact_df = vendor_contact_df.select(
        col("stg_business_entity_id"),
        col("vendor_contact_name").alias("contact_name"),
        lit(None).cast("string").alias("contact_title")
    )

    transformed_contacts = transformed_contact.unionByName(vendor_contact_df)

    transformed_contacts.show()
    transformed_contacts = transformed_contacts.withColumn(
        "business_entity_contact_id",
        compute_uuid_udf(concat_ws(",", *[col for col in transformed_contacts.columns]))
    )
    transformed_contacts.show()
	
	
	
output

"business_entity_contact_id","stg_business_entity_id","source_system_contact_id","source_system_name","contact_type","contact_name","contact_title","contact_active_indicator","contact_deactivated_date","decision_maker_indicator","decision_maker_type","is_active","created_by","created_date"
"526ca76b-1058-3957-1552-85bdb89a6c70","494a0c65-628f-83e4-7960-a72cce2dd664",NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,True,"PFD","2025-06-09 08:46:21.467"
"91891c33-008c-4118-d6ea-cfcb782edc8a","086faff0-7440-94e7-a5a4-0ea8e2a3791b",NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,True,"PFD","2025-06-09 08:46:21.467"
"b5666364-85e2-82a4-bdcb-3c9cc9e6b1ba","d14508c6-6c53-c6cd-4c89-2e96c3125233",NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,True,"PFD","2025-06-09 08:46:21.467"
"b498c34e-bc93-38e2-aff4-d5cae1d2875e","8980d8b7-b4de-1b44-a0d0-4964ed19b7b4",NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,True,"PFD","2025-06-09 08:46:21.467"


there is no vendor_contact_name(all are null) in source file. logically it shouldn't create any contact id right , if person only doesn't exist then how contact_id is getting created.

Also in transformed_json_df associated_people__name, associated_people__title there are some values. why isn't it picking up these values.

sample transformed_json_df

stg_business_entity_id	registered_agents	industries	technologies	associated_tax_ids	card_revenue__end_date	card_revenue__1m__start_date	card_revenue__1m__average_monthly_amount	card_revenue__3m__start_date	card_revenue__3m__average_monthly_amount	card_revenue__12m__start_date	card_revenue__12m__average_monthly_amount	card_transactions_stability__end_date	card_transactions_stability__date_accessible	card_transactions_stability__1m__start_date	card_transactions_stability__1m__days_present	card_transactions_stability__1m__weeks_present	card_transactions_stability__1m__months_present	card_transactions_stability__1m__daily_coverage_ratio	card_transactions_stability__1m__weekly_coverage_ratio	card_transactions_stability__1m__monthly_coverage_ratio	card_transactions_stability__3m__start_date	card_transactions_stability__3m__days_present	card_transactions_stability__3m__weeks_present	card_transactions_stability__3m__months_present	card_transactions_stability__3m__daily_coverage_ratio	card_transactions_stability__3m__weekly_coverage_ratio	card_transactions_stability__3m__monthly_coverage_ratio	card_transactions_stability__12m__start_date	card_transactions_stability__12m__days_present	card_transactions_stability__12m__weeks_present	card_transactions_stability__12m__months_present	card_transactions_stability__12m__daily_coverage_ratio	card_transactions_stability__12m__weekly_coverage_ratio	card_transactions_stability__12m__monthly_coverage_ratio	associated_people__name	associated_people__title
ff7391f5-629c-89f2-dbcd-1ab04c2f3296					8/31/2020	8/1/2020	1200.11	6/1/2020	1400.77	9/1/2020	3200.8	8/31/2020	11/15/2020	8/1/2020	25	4	1	0.8064	0.8	1	6/1/2020	61	10	3	0.6667	0.7692	1	9/1/2019	110	27	11	0.3013	0.5192	0.9167	VIRAT	CEO
ff7391f5-629c-89f2-dbcd-1ab04c2f3296					8/31/2020	8/1/2020	1200.11	6/1/2020	1400.77	9/1/2020	3200.8	8/31/2020	11/15/2020	8/1/2020	25	4	1	0.8064	0.8	1	6/1/2020	61	10	3	0.6667	0.7692	1	9/1/2019	110	27	11	0.3013	0.5192	0.9167	VIRAT	OFFICER
ff7391f5-629c-89f2-dbcd-1ab04c2f3296					8/31/2020	8/1/2020	1200.11	6/1/2020	1400.77	9/1/2020	3200.8	8/31/2020	11/15/2020	8/1/2020	25	4	1	0.8064	0.8	1	6/1/2020	61	10	3	0.6667	0.7692	1	9/1/2019	110	27	11	0.3013	0.5192	0.9167	RAVI	OFFICER
52063241-a3e2-3562-fc0a-e45dcd493182					8/31/2020	8/1/2020	1200.11	6/1/2020	1400.77	9/1/2020	3200.8	8/31/2020	11/15/2020	8/1/2020	25	4	1	0.8064	0.8	1	6/1/2020	61	10	3	0.6667	0.7692	1	9/1/2019	110	27	11	0.3013	0.5192	0.9167	VIRAT KOHLI	CEO
52063241-a3e2-3562-fc0a-e45dcd493182					8/31/2020	8/1/2020	1200.11	6/1/2020	1400.77	9/1/2020	3200.8	8/31/2020	11/15/2020	8/1/2020	25	4	1	0.8064	0.8	1	6/1/2020	61	10	3	0.6667	0.7692	1	9/1/2019	110	27	11	0.3013	0.5192	0.9167	VIRAT KOHLI	OFFICER
52063241-a3e2-3562-fc0a-e45dcd493182					8/31/2020	8/1/2020	1200.11	6/1/2020	1400.77	9/1/2020	3200.8	8/31/2020	11/15/2020	8/1/2020	25	4	1	0.8064	0.8	1	6/1/2020	61	10	3	0.6667	0.7692	1	9/1/2019	110	27	11	0.3013	0.5192	0.9167	JADEJA RAVI	OFFICER
a934454e-a853-871c-dcd4-1f8d8d3ebafe					8/31/2020	8/1/2020	1200.11	6/1/2020	1400.77	9/1/2020	3200.8	8/31/2020	11/15/2020	8/1/2020	25	4	1	0.8064	0.8	1	6/1/2020	61	10	3	0.6667	0.7692	1	9/1/2019	110	27	11	0.3013	0.5192	0.9167	RAM	CEO
a934454e-a853-871c-dcd4-1f8d8d3ebafe					8/31/2020	8/1/2020	1200.11	6/1/2020	1400.77	9/1/2020	3200.8	8/31/2020	11/15/2020	8/1/2020	25	4	1	0.8064	0.8	1	6/1/2020	61	10	3	0.6667	0.7692	1	9/1/2019	110	27	11	0.3013	0.5192	0.9167	RAM	OFFICER
a934454e-a853-871c-dcd4-1f8d8d3ebafe					8/31/2020	8/1/2020	1200.11	6/1/2020	1400.77	9/1/2020	3200.8	8/31/2020	11/15/2020	8/1/2020	25	4	1	0.8064	0.8	1	6/1/2020	61	10	3	0.6667	0.7692	1	9/1/2019	110	27	11	0.3013	0.5192	0.9167	RAVI	OFFICER
d7121504-2037-d6c6-6ef4-c2b657a4424e					8/31/2020	8/1/2020	1200.11	6/1/2020	1400.77	9/1/2020	3200.8	8/31/2020	11/15/2020	8/1/2020	25	4	1	0.8064	0.8	1	6/1/2020	61	10	3	0.6667	0.7692	1	9/1/2019	110	27	11	0.3013	0.5192	0.9167	VHLI	CEO
d7121504-2037-d6c6-6ef4-c2b657a4424e					8/31/2020	8/1/2020	1200.11	6/1/2020	1400.77	9/1/2020	3200.8	8/31/2020	11/15/2020	8/1/2020	25	4	1	0.8064	0.8	1	6/1/2020	61	10	3	0.6667	0.7692	1	9/1/2019	110	27	11	0.3013	0.5192	0.9167	VHLI	OFFICER
d7121504-2037-d6c6-6ef4-c2b657a4424e					8/31/2020	8/1/2020	1200.11	6/1/2020	1400.77	9/1/2020	3200.8	8/31/2020	11/15/2020	8/1/2020	25	4	1	0.8064	0.8	1	6/1/2020	61	10	3	0.6667	0.7692	1	9/1/2019	110	27	11	0.3013	0.5192	0.9167	J RAVI	OFFICER
d8589a20-d5ff-2f30-8381-aa7aa75b9a27					8/31/2020	8/1/2020	1200.11	6/1/2020	1400.77	9/1/2020	3200.8	8/31/2020	11/15/2020	8/1/2020	25	4	1	0.8064	0.8	1	6/1/2020	61	10	3	0.6667	0.7692	1	9/1/2019	110	27	11	0.3013	0.5192	0.9167	VIRAT KOHLI	CEO
d8589a20-d5ff-2f30-8381-aa7aa75b9a27					8/31/2020	8/1/2020	1200.11	6/1/2020	1400.77	9/1/2020	3200.8	8/31/2020	11/15/2020	8/1/2020	25	4	1	0.8064	0.8	1	6/1/2020	61	10	3	0.6667	0.7692	1	9/1/2019	110	27	11	0.3013	0.5192	0.9167	VIRAT KOHLI	OFFICER
d8589a20-d5ff-2f30-8381-aa7aa75b9a27					8/31/2020	8/1/2020	1200.11	6/1/2020	1400.77	9/1/2020	3200.8	8/31/2020	11/15/2020	8/1/2020	25	4	1	0.8064	0.8	1	6/1/2020	61	10	3	0.6667	0.7692	1	9/1/2019	110	27	11	0.3013	0.5192	0.9167	JADEJA RAVI	OFFICER

