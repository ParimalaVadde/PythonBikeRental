 transformed_association = (transformed_df
        .select(["stg_business_entity_id"] + expected_association_columns)  # Include business entity ID
        .filter(non_null_condition)
        .distinct()
        .withColumn(
            "association_name",
            when(col("ind_card_match").isin("yes", "YES"), "visa").otherwise("")
        )
    )
