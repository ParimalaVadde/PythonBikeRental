# JIRA Title
SDS Processing: Implement New PFD Fields & Fix Staging Data Load Issues

# Description
This task involves implementing end-to-end changes to integrate newly identified PFD fields into the data pipeline and resolving several known issues in the staging Glue job. The work includes mapping corrections, data format standardization, and relationship handling to ensure data quality and consistency in the SDS staging environment.

# Sub-Tasks

## Sub-Task 1: Integrate New PFD Fields into Data Pipeline
**Description:**  
Implement the mapping and processing logic for newly identified PFD fields in the data pipeline. This includes updating mapping configurations to correctly handle client_name as buyer field and adding SCF-related attributes with appropriate prefixes.

**Acceptance Criteria:**
- Updated mapping configuration to correctly process client_name field as buyer identifier
- New SCF fields (throughput_usd, avg_spread, avg_payment_terms, rate_proposed, rate_offered, esg_discount) mapped to payment_profile_attribute with "scf_" prefix
- Field ind_decline renamed to scf_ind_decline in target data
- Verified stp_partnershiplist mapping to product_segmentation_applicable
- All new fields successfully flowing through the pipeline with sample data validation

## Sub-Task 2: Fix Data Format Issues in Staging Glue Job
**Description:**  
Address data format standardization issues in the staging Glue job to ensure consistent data processing.

**Acceptance Criteria:**
- Modified registered_agents processing to maintain semicolon-separated format in characteristics table
- Updated product segmentation data handling to maintain semicolon-separated format in receivables_attribute table
- Verified data format consistency in QA environment
- Added unit tests covering format standardization logic

## Sub-Task 3: Resolve Entity Relationship Issues in Staging
**Description:**  
Fix structural issues related to entity relationships, identifiers, and contacts in the staging data load process.

**Acceptance Criteria:**
- Eliminated duplicate records for entity and relationships in identifiers table
- Updated contact_id reference handling in relationship table
- Implemented correct date format handling for start and end dates in spend_analysis
- Added logic to create new contacts when vendor_contact_name is present in relationships
- Validation report confirming all relationship integrity issues have been resolved

# Overall Acceptance Criteria
- All new PFD fields correctly integrated into the data pipeline
- All identified staging data load issues resolved
- End-to-end testing completed with sample data
- No regression in existing functionality
- Documentation updated with new field mappings and processing logic
- Code review completed and all feedback addressed
