#added 45 to 59
    # Filter DataFrame to include only columns that exist in the PostgreSQL table
    table_columns = [col.name for col in table.columns]  # Get all column names from the PostgreSQL table
    # print("Table Columns:", table_columns)  # Debugging: Print table columns

    # Ensure mapped columns exist in table_columns
    valid_columns = [
        col for col in df.columns
        if col == load_flag_column or  # Always include the load_flag_column
        col in compare_columns or      # Always include columns used for comparison
        (mapped_columns.get(col) and mapped_columns[col] in table_columns)  # Include mapped columns that exist in the table
    ]
    # print("Valid Columns:", valid_columns)  # Debugging: Print valid columns

    # Filter the DataFrame to include only valid columns
    df = df[valid_columns]
	
near update	
filter_condition = and_(
                        *[
                            func.lower(table.c[mapped_columns[col]]) == func.lower(row[col]) if isinstance(row[col], str) else table.c[mapped_columns[col]] == row[col]
                            for col in compare_columns
                        ]
                    )

                existing_record = session.query(table).filter(filter_condition).first()
                print("existing_record:", existing_record)  # Debugging: Print existing record
					
			

added below condition for insert

#added filter condition
                filter_condition = and_(
                    *[
                        func.lower(table.c[mapped_columns[col]]) == func.lower(row[col]) if isinstance(row[col], str) else table.c[mapped_columns[col]] == row[col]
                        for col in compare_columns
                    ]
                )

                existing_record = session.query(table).filter(filter_condition).first()
                if existing_record:
                    # Record already exists, add to mismatched records
                    mismatched_records.append(row.to_dict())
                else:
                    insert_data = {			
					
				
