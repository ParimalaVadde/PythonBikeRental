CREATE TABLE IF NOT EXISTS sds_staging.business_entity_characteristics
(
    characteristics_id   varchar,
    stg_business_entity_id   varchar,
    characteristics_type varchar,
    characteristic_value varchar,
    is_active            boolean,
    last_updated_by      varchar,
    last_updated_date    timestamp,
    created_by           varchar,
    created_date         timestamp,
	business_validation_reason varchar
);

stg_business_entity_id = same logic

characteristics_id = create logic generate id in format "62361987-7123-e339-7e86-f26cd5a32924" based on vendor_name_cleaned from sds_landing.analysis_pfd 

1)characteristic_value 
the value for above column should come from following columns, 
suppose for a specific characteristics_id or stg_business_entity_id, create row entry for industry_sector_dso_25, if value is null for industry_sector_dso_25 dont create an entry in row

simillary , for below columns from source

industry_sector_dso_50
industry_sector_dso_75
industry_group_dso_25
industry_group_dso_50
industry_group_dso_75


2) here also below columns to be mapped with characteristic_value
vendor_credit_rating_moody
AA
AA
ABA

vendor_credit_rating_sp
null
null
null

create again new row entry with different characteristic_value
characteristic_value="Rating;Provider;Date"
where characteristic= "Credit_Rating_Provider_Date" and Provider here is "Moody";(mean in source column "vendor_credit_rating_moody" we have moody keyword)  Record the provider , date and rating as a single data element in SDS. Here the value will be like "<rating>;<date>;moody"

example = AA;<todays date>;moody

where characteristic= "Credit_Rating_Provider_Date" and Provider here is "SP";  Record the provider , date and rating as a single data element in SDS. Here the value will be like "<rating>;<date>;sp"

if vendor_credit_rating_sp values are null then ignore


3) for below columns also map data to characteristic_value

vendor_credit_revolver_rate
vendor_cogs


ind_vc_campaign 
binary output -> if   ind_vc_campaign 
 = Y then "Y" else "N"


2)characteristic_type = map below column values to characteristic_type, row by row 

virtualcard_accpetance_tier_legacy
virtualcard_accpetance_tier_model
virtualcard_accpetance_tier_userdefined
ind_virtual_card_campaign_count
vc_campaign_accepts
registered_agents , sample values = "[ "ADVANCED WINDOWS LLC", "CORPORATION SERVICE COMPANY" ]"


for registered_agents need to split values , its list of elements , then need create 2 same rows except for characteristic_type . for one row it will be "ADVANCED WINDOWS LLC" and next row "CORPORATION SERVICE COMPANY"





